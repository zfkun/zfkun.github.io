<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7,chrome=1" />
<title>getImageData test</title>
</head>
<body>

<canvas id="myCanvas" width="500" height="500"></canvas>


<script type="text/javascript">
function draw(id) {
    var canvas = document.getElementById(id);
    if (canvas == null) {
        return false;
    }

    var context = canvas.getContext('2d');

    context.fillStyle = '#00f';
    context.font = 'italic 30px sans-serif';
    context.textBaseline = 'top';
    context.fillText('图片加载中,', 0, 0);
    context.strokeText('请稍候...', 0, 50);

    var img = new Image();
    img.onload = function() {
        context.drawImage(img, 0, 0);
        var imgData = context.getImageData(0, 0, img.width, img.height);
        for (var i = 0, n = imgData.data.length; i < n; i++) {
            imgData.data[i + 0] = 255 - imgData.data[i + 2]; //red
            imgData.data[i + 1] = 255 - imgData.data[i + 1]; //red
            imgData.data[i + 2] = 255 - imgData.data[i + 0]; //red
        }
        context.putImageData(imgData, 0, 0, 50, 50, 200, 200);
    };
    //img.src = '60055-1224118696-8.png';
}

setTimeout(function(){ draw('myCanvas'); }, 1000);
</script>

</body>
</html>